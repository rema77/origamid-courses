YUI.add("user-limits-helper",(function(i){var t=i.config.flickr.account.photo_limit,e=i.config.flickr.account.near_photo_limit;i.UserLimitsHelper={isNearUploadLimit:function(i,o){return o.getViewer().signedIn&&!o.getViewer().isPro&&i.getValue("photoCount")>=e&&i.getValue("photoCount")<t},isAtUploadLimit:function(i,e){return e.getViewer().signedIn&&!e.getViewer().isPro&&i.getValue("photoCount")===t},isOverUploadLimit:function(i,e){return e.getViewer().signedIn&&!e.getViewer().isPro&&i.getValue("photoCount")>t},isOverARRLimit:function(i,e){return e.getViewer().signedIn&&!e.getViewer().isPro&&this.getARRCount(i)>t},hasReachedNearUploadLimit:function(i,t){return this.isNearUploadLimit(i,t)||this.isAtUploadLimit(i,t)||this.isOverUploadLimit(i,t)},hasReachedUploadLimit:function(i,t){return this.isAtUploadLimit(i,t)||this.isOverUploadLimit(i,t)},remainingAvailableUploads:function(i,t){return t.getValue("uploadLimit")-i.getValue("photoCount")},getARRCount:function(i){var t=i.getValue("arrPhotoCount");return t>=0?t:i.getValue("photoCount")}}}),"@VERSION@",{requires:[]});YUI.add("html-file-dragdrop",(function(e){"use strict";var r="htmlFileDragDrop",o=r+"-drag-over",t=r+"-error",i=["image/png","image/jpeg"];e.HtmlFileDragDrop=function(r){e.config.win.File&&e.config.win.FileList&&e.config.win.FileReader&&r.dropZone&&(this.dropZone=e.one(r.dropZone),this.dropZone.on("dragover",this.handleDragOver.bind(this)),this.dropZone.on("dragleave",this.handleDragLeave.bind(this)),this.dropZone.on("drop",this.handleDrop.bind(this)))},e.HtmlFileDragDrop.prototype.reset=function(){this.dropZone.removeClass(t),this.dropZone.removeClass(o)},e.HtmlFileDragDrop.prototype.handleDragOver=function(e){e.halt(),this.reset(),this.dropZone.addClass(o)},e.HtmlFileDragDrop.prototype.handleDragLeave=function(e){e.halt(),this.reset()},e.HtmlFileDragDrop.prototype.showError=function(){this.dropZone.addClass(t)},e.HtmlFileDragDrop.prototype.handleDrop=function(e){var r;if(e.halt(),this.dropZone.removeClass(o),e._event.dataTransfer.files.length>1)return this.dropZone.addClass(t),void this.fire("drop",new Error("FILE_COUNT"));if((r=e._event.dataTransfer.files[0])&&r.name){if(i.indexOf(r.type)<0)return void this.fire("drop",new Error("FILE_TYPE"));this.fire("drop",r)}},e.augment(e.HtmlFileDragDrop,e.EventTarget,!0,null,{prefix:r})}),"@VERSION@",{affinity:"",requires:["event-custom"],optional:[]});YUI.add("hermes-template-photo-selector",(function(t,n){var e=t.Template.Handlebars.revive({1:function(t,n,e,l,a){return'\t\t<div class="photo-selector-search-list-yours">\n\t\t\t<div class="photo-selector-search-list">\n\t\t\t\t<div class="photo-selector-search-list-container">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n'},3:function(t,n,e,l,a){return'\t\t<div class="photo-selector-search-list-contacts">\n\t\t\t<div class="photo-selector-search-list">\n\t\t\t\t<div class="photo-selector-search-list-container">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n'},5:function(t,n,e,l,a){return'\t\t<div class="photo-selector-search-list-everyone">\n\t\t\t<div class="photo-selector-search-list">\n\t\t\t\t<div class="photo-selector-search-list-container">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n'},7:function(t,n,e,l,a){return'\t\t<div class="photo-selector-search-list-marketplace"\n\t\t\t<div class="photo-selector-search-list">\n\t\t\t\t<div class="photo-selector-search-list-container">\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t</div>\n'},9:function(t,n,e,l,a){var s,o=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'<div class="photo-selector-upload is-hiding">\n'+(null!=(s=o(e,"if").call(null!=n?n:t.nullContext||{},null!=n?o(n,"canUpload"):n,{name:"if",hash:{},fn:t.program(10,a,0),inverse:t.program(12,a,0),data:a,loc:{start:{line:58,column:1},end:{line:76,column:8}}}))?s:"")+"</div>\n"},10:function(t,n,e,l,a){var s=null!=n?n:t.nullContext||{},o=t.hooks.helperMissing,i=t.escapeExpression,c=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t\t<p class="upload-error"></p>\n\t\t<div class="drop-zone">\n\t\t\t<div class="drop-zone-content">\n\t\t\t\t<div class="balls"></div>\n\t\t\t\t<input type="file" class="file-select" name="file-select" accept="image/jpeg, image/png" />\n\t\t\t\t<p><i class="upload-icon"></i>'+i((c(e,"intlHTMLMessage")||n&&c(n,"intlHTMLMessage")||o).call(s,{name:"intlHTMLMessage",hash:{intlName:"wallart.DRAG_DROP_TO_UPLOAD"},data:a,loc:{start:{line:64,column:34},end:{line:64,column:92}}}))+"</p>\n\t\t\t\t<p>"+i((c(e,"intlHTMLMessage")||n&&c(n,"intlHTMLMessage")||o).call(s,{name:"intlHTMLMessage",hash:{intlName:"wallart.PHOTOS_UPLOADED_AS_PRIVATE"},data:a,loc:{start:{line:65,column:7},end:{line:65,column:72}}}))+'</p>\n\t\t\t</div>\n\t\t</div>\n\t\t<ul class="preview"></ul>\n'},12:function(t,n,e,l,a){var s=null!=n?n:t.nullContext||{},o=t.hooks.helperMissing,i=t.escapeExpression,c=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'\t\t<div class="cant-upload">\n\t\t\t<div class="cant-upload-message">\n\t\t\t\t<span>'+i((c(e,"intlMessage")||n&&c(n,"intlMessage")||o).call(s,{name:"intlMessage",hash:{limitCount:(c(e,"intlNumber")||n&&c(n,"intlNumber")||o).call(s,1e3,{name:"intlNumber",hash:{},data:a,loc:{start:{line:72,column:89},end:{line:72,column:106}}}),intlName:"upload-blocking.YOUVE_REACHED_UPLOAD_LIMIT"},data:a,loc:{start:{line:72,column:10},end:{line:72,column:108}}}))+'</span>\n\t\t\t\t<a href="/account/upgrade/pro/">'+i((c(e,"intlMessage")||n&&c(n,"intlMessage")||o).call(s,{name:"intlMessage",hash:{intlName:"common.GET_PRO"},data:a,loc:{start:{line:73,column:36},end:{line:73,column:77}}}))+"</a>\n\t\t\t</div>\n\t\t</div>\n"},14:function(t,n,e,l,a){return'<div class="group-photo-selector-photos-wrapper">\n\t<div class="group-photo-selector-photos photo-selector-photos">\n\t\t<div class="group-photo-selector-photos-container">\n\t\t</div>\n\t</div>\n</div>\n'},compiler:[8,">= 4.3.0"],main:function(t,n,e,l,a){var s,o=null!=n?n:t.nullContext||{},i=t.lookupProperty||function(t,n){if(Object.prototype.hasOwnProperty.call(t,n))return t[n]};return'<div class="photo-selector-title-bar hidden">\n\t<div class="back-to-list">\n\t\t<div class="back-to-list-icon"><svg class="icon icon-back"><use xlink:href="#icon-back"></use></svg></div>\n\t\t<div class="back-to-list-text">'+t.escapeExpression((i(e,"intlMessage")||n&&i(n,"intlMessage")||t.hooks.helperMissing).call(o,{name:"intlMessage",hash:{intlName:"common.PHOTO_SELECTOR_BACK_TO_ALBUM_LIST"},data:a,loc:{start:{line:4,column:33},end:{line:4,column:100}}}))+'</div>\n\t</div>\n\t<div class="title"></div>\n</div>\n\n<div class="photo-selector-photos-wrapper">\n\t<div class="photo-selector-photos">\n\t\t<div class="photo-selector-photos-container">\n\t\t\t<div class="loader"><div class="balls"></div></div>\n\t\t</div>\n\t</div>\n</div>\n\n\n<div class="photo-selector-search-lists-wrapper is-hiding">\n'+(null!=(s=i(e,"if").call(o,null!=(s=null!=n?i(n,"searchable"):n)?i(s,"yours"):s,{name:"if",hash:{},fn:t.program(1,a,0),inverse:t.noop,data:a,loc:{start:{line:19,column:1},end:{line:26,column:8}}}))?s:"")+"\n"+(null!=(s=i(e,"if").call(o,null!=(s=null!=n?i(n,"searchable"):n)?i(s,"contacts"):s,{name:"if",hash:{},fn:t.program(3,a,0),inverse:t.noop,data:a,loc:{start:{line:28,column:1},end:{line:35,column:8}}}))?s:"")+"\n"+(null!=(s=i(e,"if").call(o,null!=(s=null!=n?i(n,"searchable"):n)?i(s,"everyone"):s,{name:"if",hash:{},fn:t.program(5,a,0),inverse:t.noop,data:a,loc:{start:{line:37,column:1},end:{line:44,column:8}}}))?s:"")+"\n"+(null!=(s=i(e,"if").call(o,null!=(s=null!=n?i(n,"searchable"):n)?i(s,"marketplace"):s,{name:"if",hash:{},fn:t.program(7,a,0),inverse:t.noop,data:a,loc:{start:{line:46,column:1},end:{line:53,column:8}}}))?s:"")+"</div>\n\n"+(null!=(s=i(e,"if").call(o,null!=n?i(n,"hasUploadCapabilities"):n,{name:"if",hash:{},fn:t.program(9,a,0),inverse:t.noop,data:a,loc:{start:{line:56,column:0},end:{line:78,column:7}}}))?s:"")+"\n"+(null!=(s=i(e,"if").call(o,null!=n?i(n,"hasGroupCapabilities"):n,{name:"if",hash:{},fn:t.program(14,a,0),inverse:t.noop,data:a,loc:{start:{line:80,column:0},end:{line:87,column:7}}}))?s:"")},useData:!0}),l={};t.Array.each([],(function(n){var e=t.Template.get("hermes/"+n);e&&(l[n]=e)})),t.Template.register("hermes/photo-selector",(function(n,a){return(a=a||{}).partials=a.partials?t.merge(l,a.partials):l,e(n,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-infinite-scroll-load-more",(function(e,a){var t=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,t,n,l){var r=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<div class="infinite-scroll-load-more">\n\t<button class="alt">'+e.escapeExpression((r(t,"intlMessage")||a&&r(a,"intlMessage")||e.hooks.helperMissing).call(null!=a?a:e.nullContext||{},{name:"intlMessage",hash:{intlName:"common.LOAD_MORE_RESULTS"},data:l,loc:{start:{line:2,column:21},end:{line:2,column:72}}}))+"</button>\n</div>"},useData:!0}),n={};e.Array.each([],(function(a){var t=e.Template.get("hermes/"+a);t&&(n[a]=t)})),e.Template.register("hermes/infinite-scroll-load-more",(function(a,l){return(l=l||{}).partials=l.partials?e.merge(n,l.partials):n,t(a,l)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("hermes-template-license-detail",(function(e,a){var l=e.Template.Handlebars.revive({compiler:[8,">= 4.3.0"],main:function(e,a,l,n,t){var s=null!=a?a:e.nullContext||{},r=e.hooks.helperMissing,i=e.escapeExpression,o=e.lookupProperty||function(e,a){if(Object.prototype.hasOwnProperty.call(e,a))return e[a]};return'<p class="secondary" style="margin-top: 0;">'+i((o(l,"intlMessage")||a&&o(a,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:null!=a?o(a,"title"):a},data:t,loc:{start:{line:1,column:44},end:{line:1,column:74}}}))+'</p>\n<p class="secondary" style="margin-bottom: 0;">'+i((o(l,"intlMessage")||a&&o(a,"intlMessage")||r).call(s,{name:"intlMessage",hash:{intlName:null!=a?o(a,"body"):a},data:t,loc:{start:{line:2,column:47},end:{line:2,column:76}}}))+"</p>\n"},useData:!0}),n={};e.Array.each([],(function(a){var l=e.Template.get("hermes/"+a);l&&(n[a]=l)})),e.Template.register("hermes/license-detail",(function(a,t){return(t=t||{}).partials=t.partials?e.merge(n,t.partials):n,l(a,t)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});YUI.add("photo-list-layout-row",(function(t){(t.PhotoListLayoutRow=function(t){this.top=t.top,this.left=t.left,this.width=t.width,this.spacing=t.spacing,this.targetRowHeight=t.targetRowHeight,this.targetRowHeightTolerance=t.targetRowHeightTolerance,this.additionalHeight=t.additionalHeight||0,this.minAspectRatio=this.width/t.targetRowHeight*(1-t.targetRowHeightTolerance),this.maxAspectRatio=this.width/t.targetRowHeight*(1+t.targetRowHeightTolerance),this.edgeCaseMinRowHeight=t.edgeCaseMinRowHeight||Number.NEGATIVE_INFINITY,this.edgeCaseMaxRowHeight=t.edgeCaseMaxRowHeight||Number.POSITIVE_INFINITY,this.rightToLeft=t.rightToLeft,this.isBreakoutRow=t.isBreakoutRow,this.staticViewsConfig=t.staticViewsConfig,this.items=[],this.height=0}).prototype={addItem:function(i){var e,h,s,o=this.items.concat(i),a=this.width-(o.length-1)*this.spacing,g=o.reduce((function(t,i){return t+i.aspectRatio}),0),n=a/this.targetRowHeight;return i.isStaticItem&&this.staticViewsConfig&&this.staticViewsConfig.isFullRow?this.items.length>=1?(this._completeLayout(i.fullRowMinHeight||this.targetRowHeight),!1):(this.items.push(t.merge(i)),this._completeLayout(i.fullRowMinHeight||this.targetRowHeight),!0):(this.isBreakoutRow||this.isStaticItem&&!this.staticViewsConfig.isFullRow)&&0===this.items.length&&i.aspectRatio>=1?(this.items.push(t.merge(i)),this._completeLayout(a/i.aspectRatio),!0):0!==g&&(g<this.minAspectRatio?(this.items.push(t.merge(i)),!0):g>this.maxAspectRatio?i.isStaticItem||0===this.items.length?(this.items.push(t.merge(i)),this._completeLayout(a/g),!0):(e=this.width-(this.items.length-1)*this.spacing,h=this.items.reduce((function(t,i){return t+i.aspectRatio}),0),s=e/this.targetRowHeight,Math.abs(g-n)>Math.abs(h-s)?(this._completeLayout(e/h),!1):(this.items.push(t.merge(i)),this._completeLayout(a/g),!0)):(this.items.push(t.merge(i)),this._completeLayout(a/g),!0))},forceComplete:function(t,i){var e=this.width-(this.items.length-1)*this.spacing,h=this.items.reduce((function(t,i){return t+i.aspectRatio}),0);"number"==typeof i?this._completeLayout(i-this.additionalHeight,!1):t?this._completeLayout(e/h):this._completeLayout(this.targetRowHeight-this.additionalHeight,!1)},isLayoutComplete:function(){return this.height>0},getItems:function(){return this.rightToLeft?this.items.reverse():this.items},getIndexOfItem:function(t){var i=-1;return this.items.some((function(e,h){if(e.id===t)return i=h,!0})),i},setTop:function(t){this.top=t,this.items.forEach((function(i){i.geometry.top=t}))},_completeLayout:function(t,i){var e,h,s,o,a,g,n=this.rightToLeft?-this.left:this.left,r=this.width-(this.items.length-1)*this.spacing,m=this;void 0===i&&(i=!0),(h=Math.round(t))!==(s=Math.max(this.edgeCaseMinRowHeight,Math.min(h,this.edgeCaseMaxRowHeight)))?(this.height=s,e=r/s/(r/h)):(this.height=h,e=1),this.items.forEach((function(t,i){t.geometry={top:m.top,width:Math.round(t.aspectRatio*m.height*e),height:m.height+m.additionalHeight},m.rightToLeft?t.geometry.left=m.width-n-t.geometry.width:t.geometry.left=n,n+=t.geometry.width+m.spacing})),this.height+=m.additionalHeight,i&&(this.rightToLeft||(n-=this.spacing+this.left),o=(n-this.width)/this.items.length,a=this.items.map((function(t,i){return Math.round((i+1)*o)})),1===this.items.length?((g=this.items[0].geometry).width-=Math.round(o),this.rightToLeft&&(g.left+=Math.round(o))):this.items.forEach((function(t,i){i>0?(t.geometry.left-=a[i-1],t.geometry.width-=a[i]-a[i-1]):t.geometry.width-=a[i]})))}}}),"@VERSION@",{requires:[]});YUI.add("photo-list-layout",(function(t,e){var i=require("hermes-core/flog")(e),a={containerPadding:{top:8,right:8,bottom:8,left:8},itemSpacing:{horizontal:8,vertical:8},targetRowHeight:320,targetRowHeightTolerance:.25,awakeBoundsToViewportSizeRatio:3,maxNumRows:Number.POSITIVE_INFINITY,forceAspectRatio:Number.NaN,alwaysDisplayOrphans:!1,sleepTopAndBottom:!0,sleepLeftAndRight:!1,fullWidthBreakoutRowCadence:!1,deferWakeSleepUntil:2500,staticViewsConfig:{includeStaticViews:!1,isFullRow:!1,fullRowMinHeight:0,cadence:0,staticViewsQueueLength:Number.POSITIVE_INFINITY,staticViewsName:""}};(t.PhotoListLayout=function(e){if(!e.appContext)throw new Error("PhotoListLayout must be instantiated with `params.appContext`.");e=t.merge(a,e),this.appContext=e.appContext,this.containerWidth=e.containerWidth,this.viewportContainerNodeHeight=e.viewportContainerNodeHeight||this.appContext.viewportData.getHeight(),this.containerPadding=e.containerPadding,this.itemSpacing=e.itemSpacing,this.targetRowHeight=e.targetRowHeight,this.targetRowHeightTolerance=e.targetRowHeightTolerance,this.awakeBoundsToViewportSizeRatio=e.awakeBoundsToViewportSizeRatio,this.maxNumRows=e.maxNumRows,this.forceAspectRatio=e.forceAspectRatio,this.alwaysDisplayOrphans=e.alwaysDisplayOrphans,this.sleepTopAndBottom=e.sleepTopAndBottom,this.sleepLeftAndRight=e.sleepLeftAndRight,this.fullWidthBreakoutRowCadence=e.fullWidthBreakoutRowCadence,this.deferWakeSleepUntil=e.deferWakeSleepUntil,this.additionalHeight=e.additionalHeight||0,this.staticViewsConfig=e.staticViewsConfig,this.staticViewsQueueLength=e.staticViewsConfig.staticViewsQueueLength,this._layoutItems=[],this._awakeItems=[],this._inViewportItems=[],this._leadingOrphans=[],this._trailingOrphans=[],this._containerHeight=this.containerPadding.top,this._rows=[],this._orphans=[]}).prototype={getCurrentLayout:function(){return this._layoutItems.concat()},getAwakeItems:function(){return this._awakeItems.concat()},getInViewportItems:function(){return this._inViewportItems.concat()},hasLimitedNumberOfRows:function(){return this.maxNumRows!==a.maxNumRows},getLayoutItem:function(t){var e=null;return this._layoutItems.some((function(i){if(i.id===t)return e=i,!0})),e},getItemsInRow:function(t){return this._rows.length<=t?[]:this._rows[t].items.concat()},invalidateItem:function(t){var e,i=function(i,a,o){if(i.id===t)return o.splice(a,1),e=!0,!0};return this._layoutItems.some(i),this._leadingOrphans.some(i),this._trailingOrphans.some(i),this._rows.some((function(t){return t.items.some(i)})),this._orphans.some(i),e},clear:function(){this._layoutItems=[],this._leadingOrphans=[],this._trailingOrphans=[],this._containerHeight=this.containerPadding.top,this._rows=[],this._orphans=[]},updateTargetRowHeight:function(t){this.targetRowHeight=t,this.updatedRowHeight=this.targetRowHeight},computeLayout:function(t,e,a,o){var s,n,h,r,c,l,g,u,p,w={},d=[],m=[],f=[],_=!1,I=this;switch(this.containerWidth||(i.log("No valid containerWidth set on photo-list-layout; falling back to default"),this.containerWidth=1060),t||(t=[]),this.forceAspectRatio&&t.forEach((function(t){t.forcedAspectRatio=!0,t.aspectRatio=I.forceAspectRatio})),s=this._layoutItems.concat(),this._layoutItems.forEach((function(t){w[t.id]=t})),o||(o={diffType:"append"}),o.diffType){case"prepend":t=t.concat(this._leadingOrphans),this._leadingOrphans=[],t.reverse(),_=!0;break;case"relayout":o.diffDirection?"top"===o.diffDirection?t=t.concat(this._leadingOrphans.concat(this._layoutItems.concat(this._trailingOrphans))):"bottom"===o.diffDirection&&(t=this._leadingOrphans.concat(this._layoutItems.concat(this._trailingOrphans)).concat(t)):t=this._leadingOrphans.concat(this._layoutItems.concat(this._trailingOrphans)),this.clear();break;default:t=this._trailingOrphans.concat(t),this._trailingOrphans=[],this._rows.length>1&&(this._containerHeight=this._containerHeight-this.containerPadding.bottom+this.itemSpacing.vertical)}return t.some((function(t,e){if(r=!1,n||(n=I.createNewRow(_)),h=n.addItem(t),n.isLayoutComplete()){if(d=d.concat(I.addRow(n,_)),I.staticViewsConfig.includeStaticViews&&I.staticViewsConfig.isFullRow&&I.staticViewsConfig.staticViewsQueueLength>0&&I._rows&&I._rows.length%I.staticViewsConfig.cadence==0&&(n=I.createNewRow(_,!0),h=n.addItem({id:"static-item-"+e,isStaticItem:!0,fullRowMinHeight:I.staticViewsConfig.fullRowMinHeight||0,aspectRatio:1,width:500,height:I.staticViewsConfig.fullRowMinHeight||0}),n.forceComplete(!0),d=d.concat(I.addRow(n,_)),I.staticViewsConfig.staticViewsQueueLength--),I._rows.length>=I.maxNumRows)return n=null,!0;if(n=I.createNewRow(_),!h)if(h=n.addItem(t),n.isLayoutComplete()){if(d=d.concat(I.addRow(n,_)),I._rows.length>=I.maxNumRows)return n=null,!0;n=I.createNewRow(_)}else h||(r=!0)}else h||(r=!0);r&&i.warn("computeLayout() Item not added and layout not complete",t)})),this._rows.length>=this.maxNumRows?(this._layoutItems||(i.warn("computeLayout() LayoutItems are unexpectedly undefined"),this._layoutItems=[]),this._trailingOrphans=t.slice(this._layoutItems.length)):n&&n.getItems().length&&(_?o.firstPage?(n.forceComplete(!0),d=d.concat(I.addRow(n,_))):this._leadingOrphans=n.getItems().reverse():o.lastPage||this.alwaysDisplayOrphans?(this._rows.length?(p=this._rows[this._rows.length-1].isBreakoutRow?this._rows[this._rows.length-1].targetRowHeight:this._rows[this._rows.length-1].height,n.forceComplete(!1,this.updatedRowHeight||p)):this.alwaysDisplayOrphans&&s.length?s[s.length-1].geometry&&n.forceComplete(!1,this.updatedRowHeight||s[s.length-1].geometry.height):n.forceComplete(!1),d=d.concat(I.addRow(n,_)),delete this.updatedRowHeight):this._trailingOrphans=n.getItems().concat()),d.forEach((function(t){w[t.id]?f.push(t):m.push(t)})),this._containerHeight=this._containerHeight-this.itemSpacing.vertical+this.containerPadding.bottom,_&&(u=this.containerPadding.top,this._rows.forEach((function(t){t.setTop(u),u+=t.height+I.itemSpacing.vertical})),f=s.concat()),g=this.computeWakeSleep(e,a,w),c=g.wakeSleepChangedItems,l=g.inViewportChangedItems,this._trailingOrphans.concat(this._leadingOrphans).forEach((function(t){w[t.id]&&(t.isAwake=!1,c.push(t))})),{allLayoutItems:this._layoutItems.concat(),newItems:m,layoutChangedItems:f,wakeSleepChangedItems:c,inViewportChangedItems:l,leadingOrphans:this._leadingOrphans.concat(),trailingOrphans:this._trailingOrphans.concat(),containerHeight:this._containerHeight}},computeWakeSleep:function(t,e,a){var o=this._awakeItems=[],s=this._inViewportItems=[];t||(t=0),e||(e=0),this.viewportContainerNodeHeight||(i.log("No valid viewport height available for photo-list-layout; falling back to default"),this.viewportContainerNodeHeight=1e3);var n,h,r,c,l,g=this.viewportContainerNodeHeight,u=.5*g*(this.awakeBoundsToViewportSizeRatio-1),p=t,w=t+g,d=p-u,m=w+u,f=[],_=[],I=this._layoutItems.length<this.deferWakeSleepUntil,R=this;return this.sleepLeftAndRight&&(h=.5*(n=this.appContext.viewportData.getWidth())*(this.awakeBoundsToViewportSizeRatio-1),r=e-h,c=e+n+h),this._layoutItems.forEach((function(t){a&&(l=a[t.id]),I?t.isAwake=!0:(R.sleepTopAndBottom?t.isAwake=t.geometry.top+t.geometry.height>=d&&t.geometry.top<m:t.isAwake=!0,t.isAwake&&R.sleepLeftAndRight&&(t.isAwake=t.geometry.left+t.geometry.width>=r&&t.geometry.left<c)),l&&l.isAwake===t.isAwake||f.push(t),t.isAwake&&o.push(t),t.isInViewport=t.geometry.top+t.geometry.height>=p&&t.geometry.top<w,_.push(t),t.isInViewport&&s.push(t)})),{allLayoutItems:a?this._layoutItems:this._layoutItems.concat(),newItems:[],layoutChangedItems:[],wakeSleepChangedItems:f,inViewportChangedItems:_,leadingOrphans:this._leadingOrphans.concat(),trailingOrphans:this._trailingOrphans.concat(),containerHeight:this._containerHeight}},updateLayoutFrom:function(t,e){var i,a,o,s;this._layoutItems.length&&this._layoutItems.length>e&&(i=this._layoutItems[e],(a=this.getRowOfItem(i.id))&&(this._rows=this._rows.slice(0,a.index),o=this._rows[this._rows.length-1],this._containerHeight=o?o.top+o.height:0,a.indexInRow>0&&(s=(s=this._layoutItems.splice(-a.indexInRow)).map((function(t){return{id:t.id,aspectRatio:t.aspectRatio,layoutType:t.layoutType}})),t.unshift.apply(t,s))),this._layoutItems=this._layoutItems.slice(0,Math.min(this._layoutItems.length,e)))},createNewRow:function(e,i){let a=!1;return(i||!1!==this.fullWidthBreakoutRowCadence)&&(this._rows.length+1)%this.fullWidthBreakoutRowCadence==0&&(a=!0),new t.PhotoListLayoutRow({top:this._containerHeight,left:this.containerPadding.left,width:this.containerWidth-this.containerPadding.left-this.containerPadding.right,spacing:this.itemSpacing.horizontal,targetRowHeight:this.targetRowHeight,targetRowHeightTolerance:this.targetRowHeightTolerance,edgeCaseMinRowHeight:.5*this.targetRowHeight,edgeCaseMaxRowHeight:2*this.targetRowHeight,rightToLeft:e,isBreakoutRow:a,additionalHeight:this.additionalHeight,staticViewsConfig:this.staticViewsConfig})},addRow:function(t,e){return e?(this._rows.unshift(t),this._layoutItems=t.getItems().reverse().concat(this._layoutItems)):(this._rows.push(t),this._layoutItems=this._layoutItems.concat(t.getItems())),this._containerHeight+=t.height+this.itemSpacing.vertical,t.items},getRowOfItem:function(t){var e,i,a;for(i=0;i<this._rows.length;i++)if(-1!==(a=(e=this._rows[i]).getIndexOfItem(t)))return{row:e,index:i,indexInRow:a};return null}}}),"@VERSION@",{requires:["photo-list-layout-row"],optionalRequires:["hermes-core"]});YUI.add("hermes-template-photo-card-overlay-icon",(function(n,e){var o=n.Template.Handlebars.revive({1:function(n,e,o,l,a){return"\t\tautoplay\n"},3:function(n,e,o,l,a){return"\t\tvideo\n"},5:function(n,e,o,l,a){return"\t\tplay\n\t"},7:function(n,e,o,l,a){return'\t\t<svg class="icon icon-autoplay"><use xlink:href="#icon-autoplay"></use></svg>\n'},9:function(n,e,o,l,a){return'\t\t<svg class="icon icon-video"><use xlink:href="#icon-video"></use></svg>\n'},11:function(n,e,o,l,a){return'\t\t<svg class="icon icon-play"><use xlink:href="#icon-play"></use></svg>\n'},compiler:[8,">= 4.3.0"],main:function(n,e,o,l,a){var t,i=null!=e?e:n.nullContext||{},r=n.hooks.helperMissing,u=n.lookupProperty||function(n,e){if(Object.prototype.hasOwnProperty.call(n,e))return n[e]};return'<div class="photo-card-overlay-icon\n'+(null!=(t=(u(o,"ifCond")||e&&u(e,"ifCond")||r).call(i,null!=e?u(e,"type"):e,"===","autoplay",{name:"ifCond",hash:{},fn:n.program(1,a,0),inverse:n.noop,data:a,loc:{start:{line:2,column:1},end:{line:4,column:12}}}))?t:"")+(null!=(t=(u(o,"ifCond")||e&&u(e,"ifCond")||r).call(i,null!=e?u(e,"type"):e,"===","video",{name:"ifCond",hash:{},fn:n.program(3,a,0),inverse:n.noop,data:a,loc:{start:{line:5,column:1},end:{line:7,column:12}}}))?t:"")+(null!=(t=(u(o,"ifCond")||e&&u(e,"ifCond")||r).call(i,null!=e?u(e,"type"):e,"===","play",{name:"ifCond",hash:{},fn:n.program(5,a,0),inverse:n.noop,data:a,loc:{start:{line:8,column:1},end:{line:10,column:12}}}))?t:"")+'">\n\n'+(null!=(t=(u(o,"ifCond")||e&&u(e,"ifCond")||r).call(i,null!=e?u(e,"type"):e,"===","autoplay",{name:"ifCond",hash:{},fn:n.program(7,a,0),inverse:n.noop,data:a,loc:{start:{line:12,column:1},end:{line:14,column:12}}}))?t:"")+"\n"+(null!=(t=(u(o,"ifCond")||e&&u(e,"ifCond")||r).call(i,null!=e?u(e,"type"):e,"===","video",{name:"ifCond",hash:{},fn:n.program(9,a,0),inverse:n.noop,data:a,loc:{start:{line:16,column:1},end:{line:18,column:12}}}))?t:"")+"\n"+(null!=(t=(u(o,"ifCond")||e&&u(e,"ifCond")||r).call(i,null!=e?u(e,"type"):e,"===","play",{name:"ifCond",hash:{},fn:n.program(11,a,0),inverse:n.noop,data:a,loc:{start:{line:20,column:1},end:{line:22,column:12}}}))?t:"")+"\n</div>"},useData:!0}),l={};n.Array.each([],(function(e){var o=n.Template.get("hermes/"+e);o&&(l[e]=o)})),n.Template.register("hermes/photo-card-overlay-icon",(function(e,a){return(a=a||{}).partials=a.partials?n.merge(l,a.partials):l,o(e,a)}))}),"@VERSION@",{requires:["template-base","handlebars-base"]});